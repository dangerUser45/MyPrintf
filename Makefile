Compiler_asm = nasm
Compiler_cpp = g++
Linker   = ld

Target   = MyPrintf

B		 = build/
SRC      = src/
D		 = debug/

.PHONY: debug		#чтобы makefile считал исполняемым файлом скрипт $(D)debug.sh
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

$(Target): 		 			$(B)MyPrintf.o $(B)CheckMyPrintf.o
	$(Compiler_cpp) -no-pie $(B)MyPrintf.o $(B)CheckMyPrintf.o -o $(B)MyPrintf.out
#----------------------------------------------------------------------------------

$(B)MyPrintf.o : $(SRC)MyPrintf.s
	$(Compiler_asm) -f elf64 $(SRC)MyPrintf.s -o $(B)MyPrintf.o -l $(B)MyPrintf.lst
#----------------------------------------------------------------------------------

$(B)CheckMyPrintf.o :  $(SRC)CheckMyPrintf.cpp
	$(Compiler_cpp) -c $(SRC)CheckMyPrintf.cpp -o $(B)CheckMyPrintf.o
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
debug:
	make clean
	make
	$(D)debug.sh
#----------------------------------------------------------------------------------
clean:
	rm -f $(B)MyPrintf.out $(B)*.o $(B)*.lst
#----------------------------------------------------------------------------------
run:
	$(B)MyPrintf.out
#----------------------------------------------------------------------------------
